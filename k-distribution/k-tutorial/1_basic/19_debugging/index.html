<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
/>
<meta
  name="description"
  content="Design and implement your programming language and software analysis tools with mathematical rigor."
/>
<meta name="keywords" content="runtime, verification, rv, k" />
<meta name="author" content="K | Runtime Verification Inc" />
<meta name="robots" content="index, follow" />
<link rel="canonical" href="https://kframework.org/k-distribution/k-tutorial/1_basic/19_debugging/" />

<!--favicon icon-->
<link rel="icon" type="image/png" href="../../../../assets/img/favicon.ico" />

<title>K | Runtime Verification Inc</title>

<!-- <base href="/k/" /> -->

<!--web fonts-->
<link
  href="https://fonts.googleapis.com/css?family=Nunito:300,400,600,700,800"
  rel="stylesheet"
/>
<link
  href="https://fonts.googleapis.com/css?family=Lora:400i"
  rel="stylesheet"
/>

<link
  href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css"
  rel="stylesheet"
/>

<link href="../../../../assets/css/index.css" rel="stylesheet" />

<!--[if (gt IE 9) |!(IE)]><!-->
<!--<link rel="stylesheet" href="/assets/vendor/custom-nav/css/effects/fade-menu.css"/>-->
<!-- <link rel="stylesheet" href="../../../../assets/k/vl-nav/css/effects/slide-menu.css" /> -->
<!--<![endif]-->

  </head>

  <body>
<header
  class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar"
>
  <a class="logo-link" href="../../../../index.html">
    <img
      class="logo-dark"
      srcset="../../../../assets/img/k-logo.png"
      alt="K"
      style="height: 48px;"
    />
    Semantic Framework
  </a>
  <ul class="navbar-nav ml-md-auto">
    <li class="nav-item">
      <a
        class="nav-link pl-2 pr-1 mx-1 py-3 my-n2"
        href="https://github.com/runtimeverification/k"
        target="_blank"
        rel="noopener"
        aria-label="GitHub"
      >
        <i class="fab fa-github"></i>
      </a>
    </li>
  </ul>
  <a
    class="btn btn-rv-blue d-none d-lg-inline-block mb-3 mb-md-0 ml-md-3"
    href="../../../../downloads"
    >Download</a
  >
</header>


    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 bd-sidebar mb-3">
  <form
    role="search"
    class="bd-search d-flex align-items-center justify-content-between"
  >
    <input
      type="search"
      class="form-control"
      placeholder="Search..."
      aria-label="Search for..."
      autocomplete="false"
      id="search-box"
    />
    <button
      class="btn bd-search-docs-toggle d-md-none p-0 ml-3 collapsed"
      type="button"
      aria-label="Toggle docs navigation"
      style="font-size: 1.4rem"
    >
      <i class="fas fa-bars"></i>
    </button>
  </form>
  <nav class="collapse bd-links" aria-label="Main navigation">
    <div class="bd-toc-item">
      <a class="bd-toc-link" href="../../../../">Homepage</a>
      <a class="bd-toc-link" href="../../../../downloads">K Tool Binaries </a>
      <a class="bd-toc-link" href="../../../../k-distribution/k-tutorial"
        >K Tutorial</a
      >
      <a class="bd-toc-link" href="../../../../k-distribution/pl-tutorial"
        >K PL Tutorial</a
      >
      <a class="bd-toc-link" href="../../../../USER_MANUAL/">K User Manual </a>
      <a
        class="bd-toc-link"
        href="../../../../k-distribution/include/kframework/builtin/"
        >K Builtins
      </a>
      <a class="bd-toc-link" href="../../../../projects">Projects using K</a>
    </div>
  </nav>
</div>

        <main
          class="col-12 col-md-6 col-xl-8 py-md-3 pl-md-5 bd-content"
          role="main"
        >
          <div class="introduction markdown-preview"><html><head></head><body><h1 id="lesson-1.19%3A-debugging-with-gdb">Lesson 1.19: Debugging with GDB</h1>
<p>The purpose of this lesson is to teach how to debug your K interpreter using
the K-language support provided in <a href="https://www.gnu.org/software/gdb/" target="_blank" rel="noopener">GDB</a>.</p>
<h2 id="getting-started">Getting started</h2>
<p>The first thing neccessary in order to debug a K interpreter in GDB is to
build the interpreter with full debugging support enabled. This can be done
relatively simply. First, make sure you have not passed <code>-O1</code>, <code>-O2</code>, or <code>-O3</code>
to <code>kompile</code>. Second, simply add the command line flags <code>-ccopt -g -ccopt -O1</code>
to <code>kompile</code>. The resulting compiled K definition will be ready to support
debugging.</p>
<p>Once you have a compiled K definition and a program you wish to debug, you
can start the debugger by passing the <code>--debugger</code> flag to <code>krun</code>. This will
automatically load the program you are executing into GDB and drop you into
a GDB shell ready to start executing the program.</p>
<p>As an example, consider the following K definition (<code>lesson-19-a.k</code>):</p>
<pre class="language-k"><code><span class="token keyword">module</span> LESSON<span class="token operator">-</span><span class="token number">19</span><span class="token operator">-</span>A
  <span class="token keyword">imports</span> INT

  <span class="token keyword">rule</span> I <span class="token operator">=&gt;</span> I <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span>
    <span class="token keyword">requires</span> I &lt;<span class="token keyword">Int</span> <span class="token number">100</span>
<span class="token keyword">endmodule</span>
</code></pre>
<p>If we compile this definition with
<code>kompile lesson-19-a.k -ccopt -g -ccopt -O1</code>, and run the program <code>0</code> in the
debugger with <code>krun -cPGM=0 --debugger</code>, we will see the following output
(roughly):</p>
<pre class="language-text"><code>GNU gdb (Ubuntu 9.2-0ubuntu1~20.04) 9.2
Copyright (C) 2020 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type &quot;show copying&quot; and &quot;show warranty&quot; for details.
This GDB was configured as &quot;x86_64-linux-gnu&quot;.
Type &quot;show configuration&quot; for configuration details.
For bug reporting instructions, please see:
&lt;http://www.gnu.org/software/gdb/bugs/&gt;.
Find the GDB manual and other documentation resources online at:
    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.

For help, type &quot;help&quot;.
Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...
Reading symbols from ./lesson-19-a-kompiled/interpreter...
warning: File &quot;/home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-a-kompiled/interpreter&quot; auto-loading has been declined by your `auto-load safe-path&apos; set to &quot;$debugdir:$datadir/auto-load&quot;.
To enable execution of this file add
        add-auto-load-safe-path /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-a-kompiled/interpreter
line to your configuration file &quot;/home/dwightguth/.gdbinit&quot;.
To completely disable this security protection add
        set auto-load safe-path /
line to your configuration file &quot;/home/dwightguth/.gdbinit&quot;.
For more information about this security protection see the
&quot;Auto-loading safe path&quot; section in the GDB manual.  E.g., run from the shell:
        info &quot;(gdb)Auto-loading safe path&quot;
(gdb)
</code></pre>
<p>To make full advantage of the GDB features of K, you should follow the first
command listed in this output message and add the corresponding
<code>add-auto-load-safe-path</code> command to your <code>~/.gdbinit</code> file as prompted.
Please note that the path will be different on your machine than the one
listed above.</p>
<h2 id="basic-commands">Basic commands</h2>
<p>The most basic commands you can execute in the K GDB session are to run your
program or to step through it. The first can be accomplished using GDB&apos;s
built-in <code>run</code> command. This will automatically start the program and begin
executing it. It will continue until the program aborts or finishes, or the
debugger is interrupted with Ctrl-C.</p>
<p>Sometimes you want finer-grained control over how you proceed through the
program you are debugging. To step through the rule applications in your
program, you can use the <code>k start</code> and <code>k step</code> GDB commands.</p>
<p><code>k start</code> is similar to the built-in <code>start</code> command in that it starts the
program and then immediately breaks before doing any work. However, unlike
the <code>start</code> command which will break immediately after the <code>main</code> method of
a program is executed, the <code>K start</code> program will initialize the rewriter,
evaluate the initial configuration, and break immediately prior to applying
any rewrite steps.</p>
<p>In the example above, here is what we see when we run the <code>k start</code> command:</p>
<pre class="language-text"><code>Temporary breakpoint 1 at 0x239210
Starting program: /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-a-kompiled/interpreter .krun-2021-08-13-14-10-50-sMwBkbRicw/tmp.in.01aQt85TaA -1 .krun-2021-08-13-14-10-50-sMwBkbRicw/result.kore
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.

Temporary breakpoint 1, 0x0000000000239210 in main ()
0x0000000000231890 in step (subject=&lt;k&gt;
  0 ~&gt; .
&lt;/k&gt;)
(gdb)
</code></pre>
<p>As you can see, we are stopped at the <code>step</code> function in the interpreter.
This function is responsible for taking top-level rewrite steps. The <code>subject</code>
parameter to this function is the current K configuration.</p>
<p>We can step through K rewrite steps one at a time by running the <code>k step</code>
command. By default, this takes a single rewrite step (including any function
rule applications that are part of that step).</p>
<p>Here is what we see when we run that command:</p>
<pre class="language-text"><code>Continuing.

Temporary breakpoint -22, 0x0000000000231890 in step (subject=&lt;k&gt;
  1 ~&gt; .
&lt;/k&gt;)
(gdb)
</code></pre>
<p>As we can see, we have taken a single rewrite step. We can also pass a number
to the <code>k step</code> command which indicates the number of rewrite steps to take.</p>
<p>Here is what we see if we run <code>k step 10</code>:</p>
<pre class="language-text"><code>Continuing.

Temporary breakpoint -23, 0x0000000000231890 in step (subject=&lt;k&gt;
  11 ~&gt; .
&lt;/k&gt;)
(gdb)
</code></pre>
<p>As we can see, ten rewrite steps were taken.</p>
<h2 id="breakpoints">Breakpoints</h2>
<p>The next important step in debugging an application in GDB is to be able to
set breakpoints. Generally speaking, there are three types of breakpoints we
are interested in in a K semantics: Setting a breakpoint when a particular
function is called, setting a breakpoint when a particular rule is applied,
and setting a breakpoint when a side condition of a rule is evaluated.</p>
<p>The easiest way to do the first two things is to set a breakpoint on the
line of code containing the function or rule.</p>
<p>For example, consider the following K definition (<code>lesson-19-b.k</code>):</p>
<pre class="language-k"><code><span class="token keyword">module</span> LESSON<span class="token operator">-</span><span class="token number">19</span><span class="token operator">-</span>B
  <span class="token keyword">imports</span> BOOL

  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> isBlue<span class="token punctuation">(</span>Fruit<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> Fruit <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Blueberry<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">|</span> Banana<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">rule</span> isBlue<span class="token punctuation">(</span>Blueberry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
  <span class="token keyword">rule</span> isBlue<span class="token punctuation">(</span>Banana<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span>

  <span class="token keyword">rule</span> F<span class="token punctuation">:</span>Fruit <span class="token operator">=&gt;</span> isBlue<span class="token punctuation">(</span>F<span class="token punctuation">)</span>
<span class="token keyword">endmodule</span>
</code></pre>
<p>Once this program has been compiled for debugging, we can run the program
<code>Blueberry()</code>. We can then set a breakpoint that stops when the <code>isBlue</code>
function is called with the following command:</p>
<pre class="language-text"><code>break lesson-19-b.k:4
</code></pre>
<p>Here is what we see if we set this breakpoint and then run the interpreter:</p>
<pre class="language-text"><code>(gdb) break lesson-19-b.k:4
Breakpoint 1 at 0x231040: file /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-b.k, line 4.
(gdb) run
Starting program: /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-b-kompiled/interpreter .krun-2021-08-13-14-20-27-vXOQmV6lwS/tmp.in.fga98yqXlc -1 .krun-2021-08-13-14-20-27-vXOQmV6lwS/result.kore
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.

Breakpoint 1, LblisBlue&apos;LParUndsRParUnds&apos;LESSON-19-B&apos;Unds&apos;Bool&apos;Unds&apos;Fruit (_1=Blueberry ( )) at /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-b.k:4
4         syntax Bool ::= isBlue(Fruit) [function]
(gdb)
</code></pre>
<p>As we can see, we have stopped at the point where we are evaluating that
function. The value <code>_1</code> that is a parameter to that function shows the
value passed to the function by the caller.</p>
<p>We can also break when the <code>isBlue(Blueberry()) =&gt; true</code> rule applies by simply
changing the line number to the line number of that rule:</p>
<pre class="language-text"><code>(gdb) break lesson-19-b.k:6
Breakpoint 1 at 0x2af710: file /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-b.k, line 6.
(gdb) run
Starting program: /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-b-kompiled/interpreter .krun-2021-08-13-14-32-36-7kD0ic7XwD/tmp.in.8JNH5Qtmow -1 .krun-2021-08-13-14-32-36-7kD0ic7XwD/result.kore
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.

Breakpoint 1, apply_rule_138 () at /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-b.k:6
6         rule isBlue(Blueberry()) =&gt; true
(gdb)
</code></pre>
<p>We can also do the same with a top-level rule:</p>
<pre class="language-text"><code>(gdb) break lesson-19-b.k:9
Breakpoint 1 at 0x2aefa0: lesson-19-b.k:9. (2 locations)
(gdb) run
Starting program: /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-b-kompiled/interpreter .krun-2021-08-13-14-33-13-9fC8Sz4aO3/tmp.in.jih1vtxSiQ -1 .krun-2021-08-13-14-33-13-9fC8Sz4aO3/result.kore
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.

Breakpoint 1, apply_rule_107 (Var&apos;Unds&apos;DotVar0=&lt;generatedCounter&gt;
  0
&lt;/generatedCounter&gt;, Var&apos;Unds&apos;DotVar1=., VarF=Blueberry ( )) at /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-b.k:9
9         rule F:Fruit =&gt; isBlue(F)
(gdb)
</code></pre>
<p>Unlike the function rule above, we see several parameters to this function.
These are the substitution that was matched for the function. Variables only
appear in this substitution if they are actually used on the right-hand side
of the rule.</p>
<h2 id="advanced-breakpoints">Advanced breakpoints</h2>
<p>Sometimes it is inconvenient to set the breakpoint based on a line number.</p>
<p>It is also possible to set a breakpoint based on the rule label of a particular
rule. Consider the following definition (<code>lesson-19-c.k</code>):</p>
<pre class="language-k"><code><span class="token keyword">module</span> LESSON<span class="token operator">-</span><span class="token number">19</span><span class="token operator">-</span>C
  <span class="token keyword">imports</span> INT
  <span class="token keyword">imports</span> BOOL

  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> isEven<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>isEven<span class="token punctuation">]</span><span class="token punctuation">:</span> isEven<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span> <span class="token keyword">requires</span> I <span class="token operator">%</span><span class="token keyword">Int</span> <span class="token number">2</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>isOdd<span class="token punctuation">]</span><span class="token punctuation">:</span> isEven<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token keyword">requires</span> I <span class="token operator">%</span><span class="token keyword">Int</span> <span class="token number">2</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span>

<span class="token keyword">endmodule</span>
</code></pre>
<p>We will run the program <code>isEven(4)</code>. We can set a breakpoint for when a rule
applies by means of the <code>MODULE-NAME.label.rhs</code> syntax:</p>
<pre class="language-text"><code>(gdb) break LESSON-19-C.isEven.rhs
Breakpoint 1 at 0x2afda0: file /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-c.k, line 6.
(gdb) run
Starting program: /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-c-kompiled/interpreter .krun-2021-08-13-14-40-29-LNNT8YEZ61/tmp.in.ZG93vWCGGC -1 .krun-2021-08-13-14-40-29-LNNT8YEZ61/result.kore
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.

Breakpoint 1, LESSON-19-C.isEven.rhs () at /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-c.k:6
6         rule [isEven]: isEven(I) =&gt; true requires I %Int 2 ==Int 0
(gdb)
</code></pre>
<p>We can also set a breakpoint for when a rule&apos;s side condition is evaluated
by means of the <code>MODULE-NAME.label.sc</code> syntax:</p>
<pre class="language-text"><code>(gdb) break LESSON-19-C.isEven.sc
Breakpoint 1 at 0x2afd70: file /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-c.k, line 6.
(gdb) run
Starting program: /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-c-kompiled/interpreter .krun-2021-08-13-14-41-48-1BoGfJRbYc/tmp.in.kg4F8cwfCe -1 .krun-2021-08-13-14-41-48-1BoGfJRbYc/result.kore
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.

Breakpoint 1, LESSON-19-C.isEven.sc (VarI=4) at /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-c.k:6
6         rule [isEven]: isEven(I) =&gt; true requires I %Int 2 ==Int 0
(gdb) finish
Run till exit from #0  LESSON-19-C.isEven.sc (VarI=4) at /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-c.k:6
0x00000000002b2662 in LblisEven&apos;LParUndsRParUnds&apos;LESSON-19-C&apos;Unds&apos;Bool&apos;Unds&apos;Int (_1=4) at /home/dwightguth/kframework-5.0.0/k-distribution/k-tutorial/1_basic/19_debugging/lesson-19-c.k:5
5         syntax Bool ::= isEven(Int) [function]
Value returned is $1 = true
(gdb)
</code></pre>
<p>Here we have used the built-in GDB command <code>finish</code> to tell us whether the
side condition returned true or not. Note that once again, we see the
substitution that was matched from the left-hand side. Like before, a variable
will only appear here if it is used in the side condition.</p>
<h2 id="debugging-rule-matching">Debugging rule matching</h2>
<p>Sometimes it is useful to try to determine why a particular rule did or did
not apply. K provides some basic debugging commands which make it easier
to determine this.</p>
<p>Consider the following K definition (<code>lesson-19-d.k</code>):</p>
<pre class="language-k"><code><span class="token keyword">module</span> LESSON<span class="token operator">-</span><span class="token number">19</span><span class="token operator">-</span>D

  <span class="token keyword">syntax</span> Foo <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> foo<span class="token punctuation">(</span>Bar<span class="token punctuation">)</span>
  <span class="token keyword">syntax</span> Bar <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> bar<span class="token punctuation">(</span>Baz<span class="token punctuation">)</span> <span class="token operator">|</span> bar2<span class="token punctuation">(</span>Baz<span class="token punctuation">)</span>
  <span class="token keyword">syntax</span> Baz <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> baz<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">|</span> baz2<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">rule</span> <span class="token punctuation">[</span>baz<span class="token punctuation">]</span><span class="token punctuation">:</span> foo<span class="token punctuation">(</span>bar<span class="token punctuation">(</span>baz<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K

<span class="token keyword">endmodule</span>
</code></pre>
<p>Suppose we try to run the program <code>foo(bar(baz2()))</code>. It is obvious from this
example why the rule in this definition will not apply. However, in practice,
such cases are not always obvious. You might look at a rule and not immediately
spot why it didn&apos;t apply on a particular term. For this reason, it can be
useful to get the debugger to provide a log about how it tried to match that
term. You can do this with the <code>k match</code> command. If you are stopped after
having run <code>k start</code> or <code>k step</code>, you can obtain this log for any rule after
any step by running the command <code>k match MODULE.label subject</code> for a particular
top-level rule label.</p>
<p>For example, with the <code>baz</code> rule above, we get the following output:</p>
<pre class="language-text"><code>(gdb) k match LESSON-19-D.baz subject
Subject:
baz2 ( )
does not match pattern:
baz ( )
</code></pre>
<p>As we can see, it provided the exact subterm which did not match against the
rule, as well as the particular subpattern it ought to have matched against.</p>
<p>This command does not actually take any rewrite steps. In the event that
matching actually succeeds, you will still need to run the <code>k step</code> command
to advance to the next step.</p>
<h2 id="final-notes">Final notes</h2>
<p>In addition to the functionality provided above, you have the full power of
GDB at your disposal when debugging. Some features are not particularly
well-adapted to K code and may require more advanced knowledge of the
term representation or implementation to use effectively, but anything that
can be done in GDB can in theory be done using this debugging functionality.
We suggest you refer to the
<a href="https://www.gnu.org/software/gdb/documentation/" target="_blank" rel="noopener">GDB Documentation</a> if you
want to try to do something and are unsure as to how.</p>
<h2 id="exercises">Exercises</h2>
<ol>
<li>Compile your solution to Lesson 1.18, Problem 2 with debugging support
enabled and step through several programs you have previously used to test.
Then set a breakpoint on the <code>isKResult</code> function and observe the state of the
interpreter when stopped at that breakpoint. Set a breakpoint on the rule for
addition and run a program that causes it to be stopped at that breakpoint.
Finally, step through the program until the addition symbol is at the top
of the K cell, and then use the <code>k match</code> command to report the reason why
the subtraction rule does not apply. You may need to modify the definition
to insert some rule labels.</li>
</ol>
<h2 id="next-lesson">Next lesson</h2>
<p>Once you have completed the above exercises, you can continue to
<a href="../20_backends/">Lesson 1.20: K Backends and the Haskell Backend</a>.</p>
</body></html></div>
        </main>

        <!-- Page ToC -->
        <div class="col-12 col-md-3 col-xl-2 py-md-3 bd-sidebar page-toc mb-3">
          
<div>
<details style="padding:0.25rem 0;;padding-left: 0px;" open>
            <summary class="bd-toc-link-wrapper">
              <a href="#lesson-1.19%3A-debugging-with-gdb" class="bd-toc-link">Lesson 1.19: Debugging with GDB</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#getting-started"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Getting started
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#basic-commands"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Basic commands
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#breakpoints"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Breakpoints
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#advanced-breakpoints"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Advanced breakpoints
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#debugging-rule-matching"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Debugging rule matching
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#final-notes"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Final notes
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#exercises"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Exercises
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#next-lesson"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Next lesson
              </a></div>
            </div>
          </details>
        
</div>

        </div>
        <div class="btn btn-rv-blue page-toc-toggle-btn"></div>
        <!-- End Page ToC -->
      </div>
    </div>
<!-- The footer is now controlled by the k-web-theme git submodule -->
<footer id="rvsite-footer" class="app-footer text-md-left text-center">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-4 mb-md-0 mb-4">
        <a href="https://runtimeverification.com/" target="_blank">
          <picture>
            <source
              srcset="
                https://runtimeverification.com/assets/img/rv-logo-dark.png
              "
              media="(prefers-color-scheme: dark)"
            />
            <img
              class="logo-dark"
              src="https://runtimeverification.com/assets/img/rv-logo.png"
              alt="Runtime Verification logo"
              style="height: 32px"
            /> </picture
        ></a>
        <p class="mt-2 text-md-left copyright">
          <a href="https://goo.gl/maps/NYzr2iKpXMgEmQ2F6" target="_blank"
            >102 E Main St #500, Urbana, IL 61801</a
          >
        </p>
      </div>
      <div class="col-md-4 text-md-center mb-md-0 mb-4"></div>
      <div class="col-md-4 mb-md-0 mb-4 text-md-right">
        <p class="copyright">2022 © all rights reserved</p>
      </div>
    </div>
  </div>
</footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/Typist/1.2/typist.min.js"></script>
    <script src="../../../../assets/js/index.js"></script>
    <script>
      $(function () {
        // Render youtube video
        const anchorElements = document.querySelectorAll(".markdown-preview a");
        for (let i = anchorElements.length - 1; i >= 0; i--) {
          if (anchorElements.length - 1 - i > 3) {
            break;
          }
          const anchorElement = anchorElements[i];
          const href = anchorElement.getAttribute("href");
          if (href.match(/^https?:\/\/youtu.be\//)) {
            const match = href.match(/^https?:\/\/youtu.be\/(.+?)$/);
            if (match && match[1]) {
              const youtubeId = match[1];
              const $iframe = $(`
<div style="text-align:center;">
  <iframe
    width="560"
    height="315"
    src="https://www.youtube.com/embed/${youtubeId}"
    frameborder="0"
    allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    style="max-width: 100%;"
  ></iframe>
  <p>The video is out of date</p>
</div>
`);
              $(anchorElement).replaceWith($iframe[0]);
            }
          }
        }
      });
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-9LBGDMRG32"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-9LBGDMRG32");
    </script>
  </body>
</html>
