<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
/>
<meta
  name="description"
  content="Design and implement your programming language and software analysis tools with mathematical rigor."
/>
<meta name="keywords" content="runtime, verification, rv, k" />
<meta name="author" content="K | Runtime Verification Inc" />
<meta name="robots" content="index, follow" />
<link rel="canonical" href="https://kframework.org/k-distribution/k-tutorial/1_basic/02_basics/" />

<!--favicon icon-->
<link rel="icon" type="image/png" href="../../../../assets/img/favicon.ico" />

<title>K | Runtime Verification Inc</title>

<!-- <base href="/k/" /> -->

<!--web fonts-->
<link
  href="https://fonts.googleapis.com/css?family=Nunito:300,400,600,700,800"
  rel="stylesheet"
/>
<link
  href="https://fonts.googleapis.com/css?family=Lora:400i"
  rel="stylesheet"
/>

<link
  href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css"
  rel="stylesheet"
/>

<link href="../../../../assets/css/index.css" rel="stylesheet" />

<!--[if (gt IE 9) |!(IE)]><!-->
<!--<link rel="stylesheet" href="/assets/vendor/custom-nav/css/effects/fade-menu.css"/>-->
<!-- <link rel="stylesheet" href="../../../../assets/k/vl-nav/css/effects/slide-menu.css" /> -->
<!--<![endif]-->

  </head>

  <body>
<header
  class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar"
>
  <a class="logo-link" href="../../../../index.html">
    <img
      class="logo-dark"
      srcset="../../../../assets/img/k-logo.png"
      alt="K"
      style="height: 48px;"
    />
    Semantic Framework
  </a>
  <ul class="navbar-nav ml-md-auto">
    <li class="nav-item">
      <a
        class="nav-link pl-2 pr-1 mx-1 py-3 my-n2"
        href="https://github.com/kframework/k"
        target="_blank"
        rel="noopener"
        aria-label="GitHub"
      >
        <i class="fab fa-github"></i>
      </a>
    </li>
  </ul>
  <a
    class="btn btn-rv-blue d-none d-lg-inline-block mb-3 mb-md-0 ml-md-3"
    href="../../../../downloads"
    >Download</a
  >
</header>


    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 bd-sidebar mb-3">
  <form
    role="search"
    class="bd-search d-flex align-items-center justify-content-between"
  >
    <input
      type="search"
      class="form-control"
      placeholder="Search..."
      aria-label="Search for..."
      autocomplete="false"
      id="search-box"
    />
    <button
      class="btn bd-search-docs-toggle d-md-none p-0 ml-3 collapsed"
      type="button"
      aria-label="Toggle docs navigation"
      style="font-size: 1.4rem"
    >
      <i class="fas fa-bars"></i>
    </button>
  </form>
  <nav class="collapse bd-links" aria-label="Main navigation">
    <div class="bd-toc-item">
      <a class="bd-toc-link" href="../../../../">Homepage</a>
      <a class="bd-toc-link" href="../../../../downloads">Downloads</a>
      <a class="bd-toc-link" href="../../../../k-distribution/k-tutorial"
        >K Tutorial</a
      >
      <a class="bd-toc-link" href="../../../../k-distribution/pl-tutorial"
        >K PL Tutorial</a
      >
      <a class="bd-toc-link" href="../../../../pending-documentation/"
        >User documentation</a
      >
      <a
        class="bd-toc-link"
        href="../../../../k-distribution/include/kframework/builtin/"
        >Builtins</a
      >
      <a class="bd-toc-link" href="../../../../projects">Projects using K</a>
    </div>
  </nav>
</div>

        <main
          class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content"
          role="main"
        >
          <div class="introduction markdown-preview"><html><head></head><body><h1 id="lesson-1.2%3A-basics-of-functional-k">Lesson 1.2: Basics of Functional K</h1>
<p>The purpose of this lesson is to explain the basics of <strong>productions</strong> and
<strong>rules</strong> in K. These are two types of K <strong>sentences</strong>. A K file consists of
one or more <strong>requires</strong> or <strong>modules</strong> in K. Each module consists of one or
more <strong>imports</strong> or sentences. For more information on requires, modules, and
sentences, refer to <a href="../04_modules/">Lesson 1.4</a>. However, for the time
being, just think of a module as a container for sentences, and don&apos;t worry
about requires or imports just yet.</p>
<h2 id="our-first-k-program">Our first K program</h2>
<p>To start with, input the following program into your editor as file
<code>lesson-02-a.k</code>:</p>
<pre class="language-k"><code><span class="token keyword">module</span> LESSON<span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>A

  <span class="token keyword">syntax</span> Color <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Yellow<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">|</span> Blue<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">syntax</span> Fruit <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Banana<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">|</span> Blueberry<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">syntax</span> Color <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> colorOf<span class="token punctuation">(</span>Fruit<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> colorOf<span class="token punctuation">(</span>Banana<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Yellow<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">rule</span> colorOf<span class="token punctuation">(</span>Blueberry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Blue<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">endmodule</span>
</code></pre>
<p>Save this file and then run:</p>
<pre class="language-text"><code>kompile lesson-02-a.k
</code></pre>
<p><code>kompile</code> is K&apos;s compiler. By default, it takes a program or specification
written in K and compiles it into an interpreter for that input. Right now
we are compiling a single file. A set of K files that are compiled together
are called a <strong>K definition</strong>. We will cover multiple file K definitions later
on. <code>kompile</code> will output a directory containing everything needed to execute
programs or perform proofs using that definition. In this case, the directory
<code>kompile</code> will create by default will be in the current directory and will be
called <code>lesson-02-a-kompiled</code>.</p>
<p>Now, save the following input file in your editor as <code>banana.color</code> in the same
directory as <code>lesson-02-a.k</code>:</p>
<pre class="language-text"><code>colorOf(Banana())
</code></pre>
<p>We can now evaluate this K term by running (from the same directory):</p>
<pre class="language-text"><code>krun banana.color
</code></pre>
<p><code>krun</code> will use the interpreter generated by the first call to <code>kompile</code> to
execute this program.</p>
<p>You will get the following output:</p>
<pre class="language-text"><code>&lt;k&gt;
  Yellow ( ) ~&gt; .
&lt;/k&gt;
</code></pre>
<p>For now, don&apos;t worry about the <code>&lt;k&gt;</code>, <code>&lt;/k&gt;</code>, or <code> ~&gt; .</code> portions of this
output file.</p>
<p>You can also execute small programs directly by specifying them on the command
line instead of putting them in a file. For example, the same program above
could also have been executed by running the following command:</p>
<pre class="language-text"><code>krun -cPGM=&apos;colorOf(Banana())&apos;
</code></pre>
<p>Now, let&apos;s look at what this definition and program did.</p>
<h2 id="productions%2C-constructors%2C-and-functions">Productions, Constructors, and Functions</h2>
<p>The first thing to realize is that this K definition contains 5 productions.
Productions are introduced with the <strong>syntax</strong> keyword, followed by a <strong>sort</strong>,
followed by the operator <code>::=</code> followed by the definition of one or more
productions themselves, separated by the <code>|</code> operator. There are different
types of productions, but for now we only care about <strong>constructors</strong> and
<strong>functions</strong>. Each declaration separated by the <code>|</code> operator is individually
a single production, and the <code>|</code> symbol simply groups together productions that
have the same sort. For example, we could equally have written an identical K
definition like so:</p>
<pre class="language-k"><code><span class="token keyword">module</span> LESSON<span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>B

  <span class="token keyword">syntax</span> Color <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Yellow<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">syntax</span> Color <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Blue<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">syntax</span> Fruit <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Banana<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">syntax</span> Fruit <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Blueberry<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">syntax</span> Color <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> colorOf<span class="token punctuation">(</span>Fruit<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> colorOf<span class="token punctuation">(</span>Banana<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Yellow<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">rule</span> colorOf<span class="token punctuation">(</span>Blueberry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Blue<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">endmodule</span>
</code></pre>
<p>Or even:</p>
<pre class="language-k"><code><span class="token keyword">module</span> LESSON<span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>C

  <span class="token keyword">syntax</span> Color <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Yellow<span class="token punctuation">(</span><span class="token punctuation">)</span>
                 <span class="token operator">|</span> Blue<span class="token punctuation">(</span><span class="token punctuation">)</span>
                 <span class="token operator">|</span> colorOf<span class="token punctuation">(</span>Fruit<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> Fruit <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Banana<span class="token punctuation">(</span><span class="token punctuation">)</span>
                 <span class="token operator">|</span> Blueberry<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">rule</span> colorOf<span class="token punctuation">(</span>Banana<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Yellow<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">rule</span> colorOf<span class="token punctuation">(</span>Blueberry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Blue<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">endmodule</span>
</code></pre>
<p>Each of these types of productions named above has the same underlying syntax,
but context and <strong>attributes</strong> are used to distinguish between the different
types. Tokens, brackets, lists, macros, aliases, and anywhere productions will
be covered in a later lesson, but this lesson does introduce us to constructors
and functions. <code>Yellow()</code>, <code>Blue()</code>, <code>Banana()</code>, and <code>Blueberry()</code> are
constructors. You can think of a constructor like a constructor for an
algebraic data type, if you&apos;re familiar with a functional language. The data
type itself is the sort that appears on the left of the <code>::=</code> operator. Sorts
in K consist of uppercase identifiers.</p>
<p>Constructors can have arguments, but these ones do not. We will cover the
syntax of productions in detail in the next lesson, but for now, you can write
a production with no arguments as an uppercase or lowercase identifier followed
by the <code>()</code> operator.</p>
<p>A function is distinguished from a constructor by the presence of the
<strong>function</strong> attribute. Attributes appear in a comma separated list between
square brackets after any sentence, including both productions and rules.
Various attributes with built-in meanings exist in K and will be discussed
throughout the tutorial.</p>
<h3 id="exercise">Exercise</h3>
<p>Use <code>krun</code> to compute the return value of the <code>colorOf</code> function on a
<code>Blueberry()</code>.</p>
<h2 id="rules%2C-matching%2C-and-variables">Rules, Matching, and Variables</h2>
<p>Functions in K are given definitions using rules. A rule begins with the <code>rule</code>
keyword and contains at least one <strong>rewrite operator</strong>. The rewrite operator
is represented by the syntax <code>=&gt;</code>. The rewrite operator is one of the built-in
productions in K, and we will discuss in more detail how it can be used in
future lessons, but for now, you can think of a rule as consisting of a
<strong>left-hand side</strong> and a <strong>right-hand side</strong>, separated by the rewrite
operator. On the left-hand side is the name of the function and zero or more
<strong>patterns</strong> corresponding to the parameters of the function. On the right-hand
side is another pattern. The meaning of the rule is relatively simple, having
defined these components. If the function is called with arguments that
<strong>match</strong> the patterns on the left-hand side, then the return value of the
function is the pattern on the right-hand side.</p>
<p>For example, in the above example, if the argument of the <code>colorOf</code> function
is <code>Banana()</code>, then the return value of the function is <code>Yellow()</code>.</p>
<p>So far we have introduced that a constructor is a type of pattern in K. We
will introduce more complex patterns in later lessons, but there is one other
type of basic pattern: the <strong>variable</strong>. A variable, syntactically, consists
of an uppercase identifier. However, unlike a constructor, a variable will
match <strong>any</strong> pattern with one exception: Two variables with the same name
must match the same pattern.</p>
<p>Here is a more complex example:</p>
<pre class="language-k"><code><span class="token keyword">module</span> LESSON<span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>D

  <span class="token keyword">syntax</span> Container <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Jar<span class="token punctuation">(</span>Fruit<span class="token punctuation">)</span>
  <span class="token keyword">syntax</span> Fruit <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Apple<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">|</span> Pear<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">syntax</span> Fruit <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> contentsOfJar<span class="token punctuation">(</span>Container<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> contentsOfJar<span class="token punctuation">(</span>Jar<span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> F

<span class="token keyword">endmodule</span>
</code></pre>
<p>Here we see that <code>Jar</code> is a constructor with a single argument. You can write a
production with multiple arguments by putting the sorts of the arguments in a
comma-separated list inside the parentheses.</p>
<p>In this example, <code>F</code> is a variable. It will match either <code>Apple()</code> or <code>Pear()</code>.
The return value of the function is created by <strong>substituting</strong> the matched
values of all of the variables into the variables on the right-hand side of
the rule.</p>
<p>To demonstrate, compile this definition and execute the following program with
krun:</p>
<pre class="language-text"><code>contentsOfJar(Jar(Apple()))
</code></pre>
<p>You will see when you run it that the program returns <code>Apple()</code>, because that
is the pattern that was matched by <code>F</code>.</p>
<h2 id="exercises">Exercises</h2>
<ol>
<li>Extend the definition in <code>lesson-02-a.k</code> with the addition of blackberries
and kiwis. For simplicity, blackberries are black and kiwis are green. Then
compile your definition and test that your additional fruits are correctly
handled by the <code>colorOf</code> function.</li>
<li>Create a new definition which defines an outfit as a multi-argument
constructor consisting of a hat, shirt, pants, and shoes. Define a new sort,
<code>Boolean</code>, with two constructors, true and false. Each of hat, shirt, pants,
and shoes will have a single argument (a color), either black or
white. Then define an <code>outfitMatching</code> function that will return true if all
the pieces of the outfit are the same color. You do not need to define the
case that returns false. Write some tests that your function behaves the way
you expect.</li>
</ol>
<h2 id="next-lesson">Next lesson</h2>
<p>Once you have completed the above exercises, you can continue to
<a href="../03_parsing/">Lesson 1.3: BNF Syntax and Parser Generation</a>.</p>
</body></html></div>
        </main>
      </div>
    </div>
<!-- The footer is now controlled by the k-web-theme git submodule -->
<footer id="rvsite-footer" class="app-footer text-md-left text-center">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-4 mb-md-0 mb-4">
        <a href="https://runtimeverification.com/" target="_blank">
          <picture>
            <source
              srcset="
                https://runtimeverification.com/assets/img/rv-logo-dark.png
              "
              media="(prefers-color-scheme: dark)"
            />
            <img
              class="logo-dark"
              src="https://runtimeverification.com/assets/img/rv-logo.png"
              alt="Runtime Verification logo"
              style="height: 32px"
            /> </picture
        ></a>
        <p class="mt-2 text-md-left copyright">
          <a href="https://goo.gl/maps/NYzr2iKpXMgEmQ2F6" target="_blank"
            >102 E Main St #500, Urbana, IL 61801</a
          >
        </p>
      </div>
      <div class="col-md-4 text-md-center mb-md-0 mb-4"></div>
      <div class="col-md-4 mb-md-0 mb-4 text-md-right">
        <p class="copyright">2021 Â© all rights reserved</p>
      </div>
    </div>
  </div>
</footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/Typist/1.2/typist.min.js"></script>
    <script src="../../../../assets/js/index.js"></script>
    <script>
      $(function () {
        // Render youtube video
        const anchorElements = document.querySelectorAll(".markdown-preview a");
        for (let i = anchorElements.length - 1; i >= 0; i--) {
          if (anchorElements.length - 1 - i > 3) {
            break;
          }
          const anchorElement = anchorElements[i];
          const href = anchorElement.getAttribute("href");
          if (href.match(/^https?:\/\/youtu.be\//)) {
            const match = href.match(/^https?:\/\/youtu.be\/(.+?)$/);
            if (match && match[1]) {
              const youtubeId = match[1];
              const $iframe = $(`
<div style="text-align:center;">
  <iframe
    width="560"
    height="315"
    src="https://www.youtube.com/embed/${youtubeId}"
    frameborder="0"
    allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    style="max-width: 100%;"
  ></iframe>
  <p>The video is out of date</p>
</div>
`);
              $(anchorElement).replaceWith($iframe[0]);
            }
          }
        }
      });
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-9LBGDMRG32"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-9LBGDMRG32");
    </script>
  </body>
</html>
